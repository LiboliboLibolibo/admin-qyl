(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{FQLT:function(e,t,a){"use strict";var r=a("TqRt"),i=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a("pVnL")),d=r(a("RIqP")),n=r(a("MVZn")),s=r(a("lwsE")),o=r(a("W8MJ")),u=r(a("a1gu")),c=r(a("Nsbk")),p=r(a("7W2i")),f=r(a("PJYZ"));a("ozfa");var m,v,y=r(a("MJZm")),h=i(a("q1tI")),g=a("MuoO"),E=(r(a("LvDl")),y.default.TreeNode),C=(m=(0,g.connect)(function(e){var t=e.activityCreate,a=e.loading;return{activityCreate:t,loading:a.models.activityCreate}}),m(v=function(e){function t(e){var a;return(0,s.default)(this,t),a=(0,u.default)(this,(0,c.default)(t).call(this,e)),a.onExpand=function(e){a.props.dispatch({type:"activityCreate/updateState",payload:{expandedKeys:e}})},a.onCheck=function(e,t){a.state.submitTreeData;if(e.indexOf("001")>-1)a.props.dispatch({type:"activityCreate/updateState",payload:{submitTreeData:["001-\u6cb3\u5357\u7701-1"],harfAndCheckedKeys:e.join(","),checkedKeys:e}});else{var r=t.checkedNodes.map(function(e){return"".concat(e.props.dataRef.id,"-").concat(e.props.dataRef.name,"-").concat(e.props.dataRef.type)});a.props.dispatch({type:"activityCreate/updateState",payload:{submitTreeData:r,harfAndCheckedKeys:e.join(","),checkedKeys:e}})}},a.onLoadData=function(e){var t=a.props.activityCreate,r=t.expandedKeys,i=t.checkedKeys,l=(0,f.default)((0,f.default)(a));return new Promise(function(t){t(),a.props.dispatch({type:"activityCreate/atomTrees",payload:{id:e.props.eventKey,type:e.props.dataRef.type},callback:function(t,a){if("success"===t){var s=[];if(a.rows.length>0)s=a.rows.map(function(e){return(0,n.default)({key:e.id,title:e.name,isLeaf:5==e.type},e)}),e.props.dataRef.children=s,l.props.dispatch({type:"activityCreate/updateState",payload:{checkedKeys:(0,d.default)(i)}});else{var o=r.filter(function(t){return t!=e.props.id});l.props.dispatch({type:"activityCreate/updateState",payload:{expandedKeys:o}})}l.setState({treeData:(0,d.default)(l.state.treeData)})}}})})},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?h.default.createElement(E,{title:e.title,key:e.key,dataRef:e},a.renderTreeNodes(e.children)):h.default.createElement(E,(0,l.default)({dataRef:e},e))})},a.state={treeData:[{title:"\u6cb3\u5357\u7701",key:"001",type:"1",children:[]}]},a}return(0,p.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.activityCreate,a=(t.editParams,t.checkedKeys),r=t.selectedKeys,i=void 0===r?[]:r,l=t.expandedKeys,d=void 0===l?[]:l,n=e.styles;return h.default.createElement("div",{className:n.treeDiv},h.default.createElement(y.default,{showLine:!0,checkable:!0,onExpand:this.onExpand,loadData:this.onLoadData,expandedKeys:d,onCheck:this.onCheck,checkedKeys:a,selectedKeys:i},this.renderTreeNodes(this.state.treeData)))}}]),t}(h.PureComponent))||v);t.default=C},eJxV:function(e,t,a){"use strict";var r=a("TqRt"),i=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var l,d,n=r(a("bx4M")),s=r(a("ZDp4")),o=r(a("lwsE")),u=r(a("W8MJ")),c=r(a("a1gu")),p=r(a("Nsbk")),f=r(a("7W2i")),m=i(a("q1tI")),v=a("MuoO"),y=r(a("mZID")),h=r(a("FQLT")),g=r(a("vQgS")),E=(r(a("LvDl")),l=(0,v.connect)(function(e){var t=e.activityCreate,a=e.loading;return{activityCreate:t,loading:a.models.activityCreate}}),l(d=function(e){function t(){return(0,o.default)(this,t),(0,c.default)(this,(0,p.default)(t).apply(this,arguments))}return(0,f.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){return(0,s.default)(this.props.activityCreate),m.default.createElement(n.default,{className:y.default.flex_box},m.default.createElement("div",{style:{width:"18%"}},m.default.createElement(h.default,{styles:y.default})),m.default.createElement("div",{style:{width:"82%"}},m.default.createElement(g.default,{styles:y.default})))}}]),t}(m.Component))||d),C=E;t.default=C},mZID:function(e,t,a){e.exports={handleAction:"antd-pro-pages-activite-activity-create-handleAction",imgShowDiv:"antd-pro-pages-activite-activity-create-imgShowDiv",contentLabel:"antd-pro-pages-activite-activity-create-contentLabel",treeDiv:"antd-pro-pages-activite-activity-create-treeDiv",flex_box:"antd-pro-pages-activite-activity-create-flex_box"}},vQgS:function(e,t,a){"use strict";var r=a("TqRt"),i=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("14J3");var l=r(a("BMrR"));a("DZo9");var d=r(a("8z0m"));a("+L6B");var n=r(a("2/Rp"));a("Pwec");var s=r(a("CtXQ"));a("jCWc");var o=r(a("kPKH")),u=r(a("pVnL")),c=r(a("ZDp4")),p=r(a("MVZn"));a("miYZ");var f=r(a("tsqr")),m=r(a("lwsE")),v=r(a("a1gu")),y=r(a("Nsbk")),h=r(a("W8MJ")),g=r(a("7W2i")),E=r(a("PJYZ"));a("5NDa");var C=r(a("5rEg"));a("7Kak");var S=r(a("9yH6"));a("y8nQ");var T=r(a("Vl3Y"));a("OaEy");var k=r(a("2fM7"));a("iQDF");var b=r(a("+eQT")),w=i(a("q1tI")),N=a("MuoO"),D=a("v83y"),P=a("owPO"),x=r(a("wd/R")),I=a("7DNP");a("19BS");var R,U,K,M=r(a("bQ8i")),A=r(a("dt66")),O=r(a("LvDl")),L=b.default.RangePicker,q="YYYY-MM-DD",J=(k.default.Option,T.default.Item),F=S.default.Group,V=(C.default.TextArea,{labelCol:{xs:{span:24},sm:{span:6},md:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18},md:{span:18}}}),Z="<p></p>",B=(0,A.default)(Z),W=(D.ContentState.createFromBlockArray(B.contentBlocks,B.entityMap),R=(0,N.connect)(function(e){var t=e.activityCreate,a=e.loading;return{activityCreate:t,loading:a.models.activityCreate}}),U=T.default.create(),R(K=U(K=function(e){function t(e){var a;return(0,m.default)(this,t),a=(0,v.default)(this,(0,y.default)(t).call(this,e)),a.state={startTime:"",endTime:"",loading:!1},a.handleActiiteTimeChange=function(e,t){a.setState({startTime:t[0],endTime:t[1]})},a.handleSave=function(e){var t=a.props.activityCreate,r=t.themeImgUrl,i=t.submitTreeData,l=t.harfAndCheckedKeys,d=(t.checkedKeys,(0,E.default)((0,E.default)(a))),n=a.state,s=n.editorState,o=n.startTime,u=n.endTime,c=(0,M.default)((0,D.convertToRaw)(s.getCurrentContent()));e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){if(O.default.isEmpty(i))return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5bf9\u8c61\u662f\u5426\u52fe\u9009");if(O.default.isEmpty(r))return void f.default.error("\u8bf7\u68c0\u67e5\u4e3b\u9898\u56fe\u7247\u662f\u5426\u4e0a\u4f20");if("<p></p>"==c.replace(/\s/g,""))return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5185\u5bb9\u662f\u5426\u586b\u5199");a.setState({loading:!0});var n={treeNode:i,contents:c,startTime:o,endTime:u,targets:t.targets,top:t.top,picUrl:t.picUrl,activityName:t.activityName,areaids:l};a.props.dispatch({type:"activityCreate/v1",payload:(0,p.default)({},n),callback:function(e,t){d.setState({loading:!1}),"success"==e?(f.default.success("\u6d3b\u52a8\u521b\u5efa\u6210\u529f\uff01"),d.setState({editorState:D.EditorState.createEmpty()}),d.props.form.resetFields(),d.props.dispatch({type:"activityCreate/updateState",payload:{themeImgUrl:"",checkedKeys:[]}})):f.default.error("\u6d3b\u52a8\u521b\u5efa\u5931\u8d25\uff01")}})}})},a.handleEdit=function(e){var t=a.props.activityCreate,r=t.themeImgUrl,i=t.submitTreeData,l=t.harfAndCheckedKeys,d=(t.checkedKeys,(0,E.default)((0,E.default)(a))),n=a.state,s=n.editorState,o=n.startTime,u=n.endTime,c=(0,M.default)((0,D.convertToRaw)(s.getCurrentContent()));e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n=JSON.parse(sessionStorage.getItem("editParams")),s=[n.areaids,n.picUrl,n.startTime,n.endTime,n.activityId],m=s[0],v=s[1],y=s[2],h=s[3],g=s[4];if(O.default.isEmpty(i)&&!m)return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5bf9\u8c61\u662f\u5426\u52fe\u9009");if(O.default.isEmpty(r)&&!v)return void f.default.error("\u8bf7\u68c0\u67e5\u4e3b\u9898\u56fe\u7247\u662f\u5426\u4e0a\u4f20");if("<p></p>"==c.replace(/\s/g,""))return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5185\u5bb9\u662f\u5426\u586b\u5199");a.setState({loading:!0});var E={treeNode:O.default.isEmpty(i)?"":i,contents:c,startTime:o||y,endTime:u||h,targets:t.targets,top:t.top,picUrl:t.picUrl,activityName:t.activityName,areaids:l,id:g};a.props.dispatch({type:"activityCreate/updateActive",payload:(0,p.default)({},E),callback:function(e,t){d.setState({loading:!1}),"success"==e?(f.default.success("\u6d3b\u52a8\u4fee\u6539\u6210\u529f\uff01"),d.props.dispatch(I.routerRedux.push({pathname:"../activite/activity-management"})),d.props.dispatch({type:"activityCreate/updateState",payload:{isUpdate:!1}})):f.default.error("\u6d3b\u52a8\u4fee\u6539\u5931\u8d25\uff01")}})}})},a.handleMultiplex=function(e){var t=a.props.activityCreate,r=t.themeImgUrl,i=t.submitTreeData,l=t.harfAndCheckedKeys,d=(t.checkedKeys,(0,E.default)((0,E.default)(a))),n=a.state,s=n.editorState,o=n.startTime,u=n.endTime,c=(0,M.default)((0,D.convertToRaw)(s.getCurrentContent()));e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){var n=JSON.parse(sessionStorage.getItem("editParams")),s=[n.areaids,n.picUrl,n.startTime,n.endTime],m=(s[0],s[1]),v=s[2],y=s[3];if(O.default.isEmpty(i))return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5bf9\u8c61\u662f\u5426\u52fe\u9009");if(O.default.isEmpty(r)&&!m)return void f.default.error("\u8bf7\u68c0\u67e5\u4e3b\u9898\u56fe\u7247\u662f\u5426\u4e0a\u4f20");if("<p></p>"==c.replace(/\s/g,""))return void f.default.error("\u8bf7\u68c0\u67e5\u6d3b\u52a8\u5185\u5bb9\u662f\u5426\u586b\u5199");a.setState({loading:!0});var h={treeNode:O.default.isEmpty(i)?"":i,contents:c,startTime:o||v,endTime:u||y,targets:t.targets,top:t.top,picUrl:t.picUrl,activityName:t.activityName,areaids:l};a.props.dispatch({type:"activityCreate/v1",payload:(0,p.default)({},h),callback:function(e,t){d.setState({loading:!1}),"success"==e?(f.default.success("\u6d3b\u52a8\u590d\u7528\u6210\u529f\uff01"),d.props.dispatch(I.routerRedux.push({pathname:"../activite/activity-management"})),d.props.dispatch({type:"activityCreate/updateState",payload:{isUpdate:!1}})):f.default.error("\u6d3b\u52a8\u590d\u7528\u5931\u8d25\uff01")}})}})},a.deleteArtilceThemePic=function(){a.props.dispatch({type:"activityCreate/updateState",payload:{themeImgUrl:""}})},a.handleChange=function(e){"uploading"!==e.file.status?"done"===e.file.status&&getBase64(e.file.originFileObj,function(e){return a.setState({})}):a.setState({loading:!0})},a.onEditorStateChange=function(e){a.setState({editorState:e})},a.uploadImageCallBack=function(e){return(0,c.default)(a.props.activityCreate),new Promise(function(t,a){var r=new XMLHttpRequest;r.open("POST","/activities/uploadPic/v1"),r.setRequestHeader("Access-Control-Allow-Origin","*"),r.setRequestHeader("Access-Control-Allow-Headers","X-Requested-With"),r.setRequestHeader("Access-Control-Allow-Methods","GET, PUT, POST, DELETE, OPTIONS");var i=new FormData;i.append("img",e),r.send(i),r.addEventListener("load",function(){var e=JSON.parse(r.responseText);t({data:{link:e.picUrl}})}),r.addEventListener("error",function(){var e=JSON.parse(r.responseText);a(e)})})},a.onChange=function(e){if(e.file.status,"done"===e.file.status){a.props.activityCreate.themeImgUrl;f.default.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f\uff01")),a.props.dispatch({type:"activityCreate/updateState",payload:{themeImgUrl:e.file.response.picUrl}})}else"error"===e.file.status&&f.default.error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25\uff01."))},a.handleCancel=function(){var e=a.props.activityCreate.isUpdate,t=a.props.form.resetFields;a.state.editorState;e?a.props.dispatch(I.routerRedux.push({pathname:"../activite/activity-management"})):(t(),a.setState({editorState:D.EditorState.createEmpty()}))},a.state={editorState:D.EditorState.createEmpty()},a}return(0,g.default)(t,e),(0,h.default)(t,[{key:"componentWillMount",value:function(){if(sessionStorage.getItem("editParams")){var e=JSON.parse(sessionStorage.getItem("editParams")),t=e.contents;if(t){var a=(0,A.default)(t),r=D.ContentState.createFromBlockArray(a.contentBlocks,a.entityMap);this.setState({editorState:D.EditorState.createWithContent(r)}),this.props.dispatch({type:"activityCreate/updateState",payload:{isUpdate:""!=sessionStorage.getItem("editParams")}})}}}}]),(0,h.default)(t,[{key:"render",value:function(){var e=this.props,t=e.activityCreate,a=t.themeImgUrl,r=(t.submitTreeData,t.isUpdate),i=void 0!==r&&r,c=e.styles,p=this.props.form,f=p.getFieldDecorator,m=(p.setFieldsValue,this.state.editorState),v=[],y=v[0],h=v[1],g=v[2],E=v[3],k=v[4],b=v[5],N=!1;if(i&&sessionStorage.getItem("editParams")){var D=JSON.parse(sessionStorage.getItem("editParams")),I=JSON.parse(sessionStorage.getItem("editParams")).multiplex,R=[D.picUrl,D.startTime,D.endTime,D.activityName,D.targets,D.top];y=R[0],h=R[1],g=R[2],E=R[3],k=R[4],b=R[5],N=I}var U={name:"img",action:"/activities/uploadPic/v1",headers:{authorization:"authorization-text"},data:{},showUploadList:!1};return w.default.createElement("div",null,w.default.createElement(l.default,null,w.default.createElement(T.default,null,w.default.createElement(o.default,{span:"12"},w.default.createElement(l.default,null,w.default.createElement("div",null,w.default.createElement(o.default,{span:"24"},w.default.createElement(J,(0,u.default)({},V,{label:"\u6d3b\u52a8\u540d\u79f0:"}),f("activityName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d\u79f0\uff01"}],initialValue:i&&E?E:""})(w.default.createElement(C.default,{style:{width:200}})))),w.default.createElement(o.default,{span:"24"},w.default.createElement(J,(0,u.default)({},V,{label:"\u6d3b\u52a8\u65f6\u95f4:"}),f("activeTime",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6d3b\u52a8\u65f6\u95f4\uff01"}],initialValue:i&&h&&g?[(0,x.default)(h,q),(0,x.default)(g,q)]:[],onChange:this.handleActiiteTimeChange})(w.default.createElement(L,{style:{width:260},showTime:!0})))),w.default.createElement(o.default,{span:"24"},w.default.createElement(J,(0,u.default)({},V,{label:"\u5bf9\u8c61:"}),f("targets",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u53d1\u9001\u5bf9\u8c61"}],initialValue:i&&k?Number(k):""})(w.default.createElement(F,null,w.default.createElement(S.default,{value:0},"\u6240\u6709\u5b66\u751f"),w.default.createElement(S.default,{value:1},"\u4ec5\u5c0f\u8bb0\u8005"))))),w.default.createElement(o.default,{span:"24"},w.default.createElement(J,(0,u.default)({},V,{label:"\u662f\u5426\u7f6e\u9876:"}),f("top",{rules:[{required:!0,message:"\u9009\u62e9\u662f\u5426\u7f6e\u9876"}],initialValue:i&&b?Number(b):""})(w.default.createElement(F,null,w.default.createElement(S.default,{value:1},"\u662f"),w.default.createElement(S.default,{value:0},"\u5426"))))),w.default.createElement(o.default,{span:"24"},w.default.createElement(J,(0,u.default)({},V,{label:"\u4e3b\u9898\u56fe\u7247:"}),f("picUrl",{initialValue:i&&y?y:a})(w.default.createElement(C.default,{style:{width:240,display:"none"}})),w.default.createElement("span",null,w.default.createElement("div",{className:c.imgShowDiv},(i||!O.default.isEmpty(a))&&w.default.createElement("img",{src:i&&y?y:a,alt:"\u4e3b\u9898\u56fe\u7247"})),w.default.createElement(o.default,null,w.default.createElement(o.default,{span:"5"},w.default.createElement(d.default,(0,u.default)({},U,{onChange:this.onChange}),w.default.createElement(n.default,{size:"small",style:{marginRight:10}},w.default.createElement(s.default,{type:"upload"})," \u6dfb\u52a0\u56fe\u7247"))),w.default.createElement(o.default,{style:{marginLeft:10},span:"5"},w.default.createElement(n.default,{onClick:this.deleteArtilceThemePic,size:"small",type:"danger"},w.default.createElement(s.default,{type:"delete"}),"\u79fb\u9664\u56fe\u7247"))))))))),w.default.createElement(o.default,{span:"12"},w.default.createElement(J,(0,u.default)({},V,{className:c.contentLabel,label:"\u5185\u5bb9:"}),f("articleContent",{initialValue:""})(w.default.createElement(C.default,{style:{width:240,display:"none"}}))),w.default.createElement("div",{style:{minHeight:560,border:"1px solid #ddd"}},w.default.createElement(P.Editor,{editorState:m,wrapperClassName:"wrapper-class",editorClassName:"editor-class",toolbarClassName:"toolbar-class",localization:{locale:"zh"},placeholder:" \u8bf7\u8f93\u5165\u5185\u5bb9 ",onEditorStateChange:this.onEditorStateChange,toolbar:{fontFamily:{options:["\u5b8b\u4f53","\u9ed1\u4f53","\u6977\u4f53","\u5fae\u8f6f\u96c5\u9ed1","Arial","Georgia","Impact","Tahoma","Times New Roman","Verdana"]},image:{uploadCallback:this.uploadImageCallBack}}}))))),w.default.createElement(l.default,null,w.default.createElement(o.default,{className:c.handleAction,span:"24"},w.default.createElement(n.default,{loading:this.state.loading,type:"primary",onClick:i?0==N?this.handleEdit:this.handleMultiplex:this.handleSave},"\u786e\u5b9a"),w.default.createElement(n.default,{onClick:this.handleCancel},"\u53d6\u6d88"))))}}]),t}(w.PureComponent))||K)||K);t.default=W}}]);